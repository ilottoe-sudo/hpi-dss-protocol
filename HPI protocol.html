<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HPI-DSS äº’å‹•æ€§è¡€æµå‹•åŠ›å­¸æ±ºç­–å”è­° (Interactive HPI-DSS Protocol)</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f6;
            color: #333;
        }
        .container {
            max-width: 1200px; /* æ“´å¤§å®¹å™¨ä»¥å®¹ç´åœ–ç‰‡ */
            margin: auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
        }
        h1 {
            color: #007bff;
            text-align: center;
            width: 100%;
            margin-bottom: 5px;
        }
        .activation-header {
            text-align: center;
            color: white;
            background-color: #dc3545;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 1.2em;
            font-weight: bold;
            width: 100%;
        }

        /* åœ–ç‰‡å®¹å™¨ */
        .image-container {
            width: 45%; /* ä½”æ“šå®¹å™¨ç´„ä¸€åŠå¯¬åº¦ */
            min-width: 400px; 
            order: 1; /* è®“åœ–ç‰‡å…ˆé¡¯ç¤º */
        }
        .image-container img {
            max-width: 100%;
            height: auto;
            border: 2px solid #adb5bd;
            border-radius: 8px;
        }

        /* å”è­°äº’å‹•å’Œæ–‡å­—åƒè€ƒå€åŸŸ */
        .protocol-content-area {
            width: 45%;
            min-width: 400px;
            order: 2; /* è®“æ–‡å­—å…§å®¹åœ¨åœ–ç‰‡æ—é‚Š */
        }

        h3 {
            color: #6c757d;
            border-bottom: 2px solid #adb5bd;
            padding-bottom: 5px;
            margin-top: 25px;
        }
        /* å®Œæ•´å”è­°æ–‡å­—å€å¡Š */
        #full-protocol-static {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        #full-protocol-static ul, #full-protocol-static ol {
            list-style: none;
            padding-left: 10px;
        }
        #full-protocol-static li {
            padding: 5px 10px;
            border-left: 2px solid #adb5bd;
            margin: 5px 0;
            transition: background-color 0.3s;
        }
        /* çªå‡ºé¡¯ç¤ºç•¶å‰æ­¥é©Ÿ */
        .highlight {
            background-color: #ffc107; /* äº®é»ƒè‰²é«˜äº® */
            font-weight: bold;
            color: #333;
            border-left: 4px solid #007bff !important;
        }
        /* äº’å‹•å€å¡Š */
        .protocol-section {
            background-color: #e9ecef;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .question {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #0056b3;
        }
        .buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        .btn {
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            border: none;
            border-radius: 6px;
            transition: background-color 0.3s, transform 0.1s;
        }
        .btn-yes {
            background-color: #28a745;
            color: white;
        }
        .btn-no {
            background-color: #dc3545;
            color: white;
        }
        .result-box {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 1.1em;
            display: none;
        }
        .reset-btn {
            background-color: #6c757d;
            color: white;
            margin-top: 20px;
            display: block;
            width: 100%;
            text-align: center;
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆèª¿æ•´ */
        @media (max-width: 992px) {
            .image-container, .protocol-content-area {
                width: 100%;
                min-width: unset;
                order: unset;
            }
            .container {
                max-width: 95%;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>HPI-DSS äº’å‹•æ€§è¡€æµå‹•åŠ›å­¸æ±ºç­–å”è­°</h1>
    
    <div class="activation-header">ğŸš¨ å”è­°å•Ÿå‹•æ¢ä»¶ï¼šHPI > 80% ğŸš¨</div>

    <div class="image-container">
        <h3>è¦–è¦ºåŒ–æµç¨‹åœ–ï¼šåœ– 1</h3>
        <img src="image_ce6308.png" alt="è¡€æµå‹•åŠ›å­¸æ²»ç™‚æ¼”ç®—æ³•åœ–">
    </div>

    <div class="protocol-content-area">
        
        <div id="full-protocol-static">
            <h3>å®Œæ•´æ±ºç­–è·¯å¾‘åƒè€ƒ (æ–‡å­—ç‰ˆ)</h3>
            <ul style="padding-left: 0;">
                <li id="step_ACTION" style="font-weight: bold; padding: 10px; background-color: #e9ecef;">I-1: HPI > 80% è§¸ç™¼å‹•ä½œ (ACTION)</li>
                <ul style="padding-left: 20px;">
                    <li id="step_A">å•é¡Œ Aï¼šSVV â‰¥ 13%ï¼Ÿ (åˆ¤æ–·è¼¸æ¶²åæ‡‰æ€§)</li>
                    <ul style="padding-left: 20px;">
                        <li id="step_B" style="color: #28a745;">**ã€è·¯å¾‘ I: SVV â‰¥ 13%ã€‘** å•é¡Œ Bï¼šEadyn â‰¥ 1ï¼Ÿ (çµ•å° vs ç›¸å°è¡€å®¹é‡ä¸è¶³)</li>
                        <ul style="padding-left: 40px;">
                            <li id="result_ABSOLUTE_HYPOVOLEMIA">çµæœï¼šçµ•å°è¡€å®¹é‡ä¸è¶³ â†’ **CRYSTALLOID 250 ml**</li>
                            <li id="result_RELATIVE_HYPOVOLEMIA">çµæœï¼šç›¸å°è¡€å®¹é‡ä¸è¶³ â†’ **CRYSTALLOID 250 ml + PHENILEPRINE 100 mg** (éœ€æª¢æŸ¥ HR â‰¤ 60)</li>
                        </ul>
                    </ul>
                    <ul style="padding-left: 20px;">
                        <li id="step_C" style="color: #0056b3;">**ã€è·¯å¾‘ II: SVV < 13%ã€‘** å•é¡Œ Cï¼šdP/dt â‰¥ 400ï¼Ÿ (åˆ¤æ–·å¿ƒè‚Œæ”¶ç¸®åŠ›)</li>
                        <ul style="padding-left: 40px;">
                            <li id="result_VASOPLEGIA">çµæœï¼šè¡€ç®¡éº»ç—º (Vasoplegia) â†’ **EPHEDRINE/NORADRENALINE**</li>
                            <li id="step_E">å•é¡Œ Eï¼šRVSI â‰¥ 1500ï¼Ÿ (ç´°åˆ†å¿ƒè‚ŒæŠ‘åˆ¶)</li>
                            <ul style="padding-left: 60px;">
                                <li id="result_MYOCARDIAL_DEPRESSION">çµæœï¼šå¿ƒè‚ŒæŠ‘åˆ¶ â†’ **DOBUTAMINE 2.5-5 Âµg/kg/min**</li>
                                <li id="result_DEPRESSION_VASOPLEGIA">çµæœï¼šä¼´æœ‰è¡€ç®¡éº»ç—ºçš„å¿ƒè‚ŒæŠ‘åˆ¶ â†’ **EPHEDRINE/NORADRENALINE**</li>
                            </ul>
                        </ul>
                    </ul>
                </ul>
            </ul>
            <p style="font-size: 0.9em; margin-top: 15px; color: #6c757d;">*æ­¤è™•çš„è·¯å¾‘ I å·²ç¶“ç°¡åŒ–äº†åœ–ä¸­é‡å° HR â‰¤ 60 å’Œ SVV â‰¥ 16 çš„ç´°åˆ†æ­¥é©Ÿï¼Œä»¥é…åˆæ ¸å¿ƒåƒæ•¸å•ç­”æµç¨‹ã€‚</p>
        </div>
        
        <div id="protocol" class="protocol-section">
            </div>

        <div id="result" class="result-box">
            <strong>æœ€çµ‚è¨ºæ–·è¡¨å‹ï¼š</strong><span id="phenotype"></span><br>
            <div class="treatment"><strong>æ²»ç™‚å»ºè­°ï¼š</strong><span id="treatment"></span></div>
        </div>
        
        <button id="reset-btn" class="btn reset-btn" onclick="startProtocol()">é‡æ–°é–‹å§‹è¨ºæ–·</button>
    </div>

</div>

<script>
    const protocolDiv = document.getElementById('protocol');
    const resultDiv = document.getElementById('result');
    const phenotypeSpan = document.getElementById('phenotype');
    const treatmentSpan = document.getElementById('treatment');
    const fullProtocolItems = document.querySelectorAll('#full-protocol-static li');

    // å®šç¾©å”è­°çš„ç‹€æ…‹å’Œæ­¥é©Ÿ (èª¿æ•´ç‚ºå°æ‡‰åœ– 1 çš„æ ¸å¿ƒæ±ºç­–é»)
    const steps = {
        START: {
            question: "ã€ç¬¬ä¸€æ­¥ï¼šSVVã€‘SVVï¼ˆæ¯æè¼¸å‡ºé‡è®Šç•°ï¼‰æ˜¯å¦ â‰¥ 13%ï¼Ÿ",
            path: { YES: 'B_Eadyn', NO: 'C_dPdt' },
            id: 'step_A'
        },
        // è·¯å¾‘ I: SVV â‰¥ 13% - åˆ¤æ–· Eadyn
        B_Eadyn: {
            question: "ã€å•é¡Œ Bï¼šEadynã€‘Eadynï¼ˆå‹•æ…‹å‹•è„ˆå½ˆæ€§ï¼‰æ˜¯å¦ â‰¥ 1ï¼Ÿ",
            path: { YES: 'RESULT_ABSOLUTE_HYPOVOLEMIA', NO: 'RESULT_RELATIVE_HYPOVOLEMIA' },
            id: 'step_B' 
        },
        // è·¯å¾‘ II-1: SVV < 13% - åˆ¤æ–· dP/dt
        C_dPdt: {
            question: "ã€å•é¡Œ Cï¼šdP/dtã€‘dP/dtï¼ˆæœ€å¤§å‹•è„ˆå£“ä¸Šå‡æ–œç‡ï¼‰æ˜¯å¦ â‰¥ 400 mmHg/sï¼Ÿ",
            path: { YES: 'RESULT_VASOPLEGIA', NO: 'E_RVSI' },
            id: 'step_C'
        },
        // è·¯å¾‘ II-2: SVV < 13% ä¸” dP/dt < 400 - åˆ¤æ–· RVSI
        E_RVSI: {
            question: "ã€å•é¡Œ Eï¼šRVSIã€‘RVSIï¼ˆå…¨èº«è¡€ç®¡é˜»åŠ›æŒ‡æ•¸ï¼‰æ˜¯å¦ â‰¥ 1500 dynÂ·s/cmâµ/mÂ²ï¼Ÿ",
            path: { YES: 'RESULT_MYOCARDIAL_DEPRESSION', NO: 'RESULT_DEPRESSION_VASOPLEGIA' },
            id: 'step_E'
        },

        // çµæœå®šç¾© (èˆ‡åœ– 1 ä¿æŒä¸€è‡´)
        RESULT_ABSOLUTE_HYPOVOLEMIA: {
            phenotype: "çµ•å°è¡€å®¹é‡ä¸è¶³ (Absolute Hypovolemia)",
            treatment: "éœ€é€²ä¸€æ­¥åˆ¤æ–· SVVâ‰¥16 å’Œ HRâ‰¤60 å¾Œï¼Œå»ºè­°ä½¿ç”¨ CRYSTALLOID 250 ml åŠ/æˆ– EPHEDRINE/PHENILEPRINEã€‚",
            id: 'result_ABSOLUTE_HYPOVOLEMIA'
        },
        RESULT_RELATIVE_HYPOVOLEMIA: {
            phenotype: "ç›¸å°è¡€å®¹é‡ä¸è¶³ (Relative Hypovolemia)",
            treatment: "å»ºè­°ä½¿ç”¨ CRYSTALLOID 250 ml + PHENILEPRINE 100 mgã€‚",
            id: 'result_RELATIVE_HYPOVOLEMIA'
        },
        RESULT_VASOPLEGIA: {
            phenotype: "è¡€ç®¡éº»ç—º (Vasoplegia)",
            treatment: "EPHEDRINE 5-10 mgï¼›è‹¥ 3 åŠ‘ Ephedrine ç„¡æ•ˆï¼Œä½¿ç”¨ NORADRENALINE 0.05 Âµg/kg/hã€‚",
            id: 'result_VASOPLEGIA'
        },
        RESULT_MYOCARDIAL_DEPRESSION: {
            phenotype: "å¿ƒè‚ŒæŠ‘åˆ¶ (Myocardial Depression)",
            treatment: "DOBUTAMINE 2.5-5 Âµg/kg/minã€‚",
            id: 'result_MYOCARDIAL_DEPRESSION'
        },
        RESULT_DEPRESSION_VASOPLEGIA: {
            phenotype: "ä¼´æœ‰è¡€ç®¡éº»ç—ºçš„å¿ƒè‚ŒæŠ‘åˆ¶ (Myocardial Depression with Vasoplegia)",
            treatment: "EPHEDRINE 5-10 mgï¼›è‹¥ 3 åŠ‘ Ephedrine ç„¡æ•ˆï¼Œä½¿ç”¨ NORADRENALINE 0.05 Âµg/kg/hã€‚",
            id: 'result_DEPRESSION_VASOPLEGIA'
        }
    };

    let currentStep = 'START';

    function startProtocol() {
        currentStep = 'START';
        resultDiv.style.display = 'none';
        renderStep();
        // é‡è¨­èµ·å§‹é»é«˜äº®
        fullProtocolItems.forEach(item => item.classList.remove('highlight'));
        document.getElementById('step_ACTION').classList.add('highlight');
    }

    function renderStep() {
        const step = steps[currentStep];
        if (!step) return;

        // 1. æ¸…é™¤æ‰€æœ‰é«˜äº®ä¸¦é«˜äº®ç•¶å‰æ­¥é©Ÿ
        fullProtocolItems.forEach(item => item.classList.remove('highlight'));
        document.getElementById('step_ACTION').classList.add('highlight'); // ä¿ç•™ ACTION é«˜äº®
        
        const currentItem = document.getElementById(step.id);
        if (currentItem) {
            currentItem.classList.add('highlight');
        }

        protocolDiv.innerHTML = '';
        
        if (currentStep.startsWith('RESULT')) {
            // 2. é¡¯ç¤ºçµæœ
            phenotypeSpan.textContent = step.phenotype;
            treatmentSpan.textContent = step.treatment;
            resultDiv.style.display = 'block';
            protocolDiv.innerHTML = `<p style="color: #155724; font-weight: bold;">âœ… è¨ºæ–·å®Œæˆï¼Œè«‹æŸ¥çœ‹ä¸‹æ–¹çµæœèˆ‡æ²»ç™‚å»ºè­°ã€‚</p>`;
        } else {
            // 3. é¡¯ç¤ºå•é¡Œå’ŒæŒ‰éˆ•
            protocolDiv.innerHTML = `
                <div class="question">${step.question}</div>
                <div class="buttons">
                    <button class="btn btn-yes" onclick="handleAnswer('YES')">æ˜¯ (YES)</button>
                    <button class="btn btn-no" onclick="handleAnswer('NO')">å¦ (NO)</button>
                </div>
                <p style="font-size: 0.9em; color: #6c757d;">è«‹æ ¹æ“šå¯¦æ™‚ç›£æ¸¬æ•¸æ“šé»æ“Šå°æ‡‰æŒ‰éˆ•ã€‚</p>
            `;
        }
    }

    function handleAnswer(answer) {
        const step = steps[currentStep];
        if (step && step.path) {
            const nextStepKey = (answer === 'YES' ? 'YES' : 'NO');
            currentStep = step.path[nextStepKey];
            renderStep();
        }
    }

    // é¦–æ¬¡åŠ è¼‰æ™‚å•Ÿå‹•å”è­°
    window.onload = startProtocol;
</script>

</body>
</html>